# 관리자 추첨 관리 시스템 테스트 가이드

## 구현된 기능

### 백엔드 (NestJS + GraphQL)

1. **관리자 전용 서비스 메서드**
   - `adminStopCurrentLottery()`: 진행 중인 추첨 강제 중단
   - `adminCreateCustomLottery()`: 커스텀 설정으로 새 추첨 생성
   - `getAdminLotteryStats()`: 추첨 통계 조회

2. **관리자 전용 GraphQL 리졸버**
   - `adminStopCurrentLottery`: 추첨 중단 뮤테이션
   - `adminCreateCustomLottery`: 커스텀 추첨 생성 뮤테이션
   - `adminLotteryStats`: 추첨 통계 조회 쿼리

3. **관리자 권한 가드**
   - `AdminGuard`: 관리자 권한 체크
   - `GqlAuthGuard`와 함께 사용하여 이중 보안

### 프론트엔드 (React Native + Expo)

1. **GraphQL 쿼리/뮤테이션**
   - `ADMIN_STOP_CURRENT_LOTTERY`: 추첨 중단
   - `ADMIN_CREATE_CUSTOM_LOTTERY`: 커스텀 추첨 생성
   - `GET_ADMIN_LOTTERY_STATS`: 통계 조회

2. **관리자 대시보드 추첨 관리 섹션**
   - 현재 추첨 상태 실시간 표시
   - 추첨 통계 (총 추첨, 진행 중, 총 응모, 지급 상금)
   - 추첨 중단 버튼
   - 이벤트 추첨 생성 버튼

3. **추첨 생성 모달**
   - 총 상금 설정 (100P ~ 50,000P)
   - 당첨자 수 설정 (1명 ~ 20명)
   - 응모 기간 설정 (10분 ~ 120분)
   - 실시간 미리보기

## 테스트 시나리오

### 1. 관리자 권한 테스트

```bash
# 관리자가 아닌 사용자로 접근 시 오류 발생 확인
# AdminGuard에서 ForbiddenException 발생
```

### 2. 추첨 중단 테스트

```bash
# 1. 진행 중인 추첨이 있는 상태에서 중단 버튼 클릭
# 2. 추첨 상태가 CANCELLED로 변경되는지 확인
# 3. 새로운 추첨이 자동 생성되지 않는지 확인
```

### 3. 커스텀 추첨 생성 테스트

```bash
# 1. 이벤트 추첨 생성 버튼 클릭
# 2. 모달에서 설정값 입력
# 3. 생성 버튼 클릭 후 새 추첨 생성 확인
# 4. 설정한 값들이 올바르게 적용되었는지 확인
```

### 4. 통계 조회 테스트

```bash
# 1. 대시보드 로드 시 통계 정보 표시 확인
# 2. 추첨 생성/중단 후 통계 업데이트 확인
# 3. 실시간 폴링으로 데이터 갱신 확인
```

## 주요 특징

1. **실시간 업데이트**: 30초마다 추첨 상태, 60초마다 통계 폴링
2. **입력 검증**: 프론트엔드와 백엔드 양쪽에서 입력값 검증
3. **권한 보안**: AdminGuard로 관리자만 접근 가능
4. **사용자 경험**: 로딩 상태, 토스트 알림, 확인 다이얼로그
5. **데이터 일관성**: 추첨 중단 시 기존 추첨 CANCELLED 처리

## 커밋 메시지

```
feat: 관리자 추첨 관리 시스템 구현

- 관리자가 진행 중인 추첨을 중단할 수 있는 기능 추가
- 커스텀 설정으로 이벤트 추첨을 생성할 수 있는 기능 추가
- 응모 기간, 총 상금, 당첨자 수를 관리자가 조정 가능
- 대시보드에 추첨 관리 섹션 및 통계 표시 추가
- AdminGuard로 관리자 권한 보안 강화
```
